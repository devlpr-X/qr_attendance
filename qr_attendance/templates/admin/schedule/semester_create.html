{# templates/admin/schedule/semester_create.html #}
{% extends "base.html" %}
{% block title %}–°–µ–º–µ—Å—Ç—Ä “Ø“Ø—Å–≥—ç—Ö{% endblock %}

{% block content %}
<style>
  .form-container { max-width: 720px; margin: 2rem auto; background: white;
                    padding: 2rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
  .form-group { margin-bottom: 1rem; }
  label { display:block; margin-bottom:0.5rem; font-weight:600; }
  input, select { width:100%; padding:0.7rem; border:1px solid #ddd; border-radius:4px; }
  .row { display:grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:1rem; }
  .btn-row { display:flex; gap:0.5rem; margin-top:1rem; }
  .btn-primary { background:#2e7d32; color:white; padding:0.8rem 1rem; border:none; border-radius:4px; cursor:pointer; }
  .btn-secondary { background:#757575; color:white; padding:0.8rem 1rem; border:none; border-radius:4px; cursor:pointer; }
  .error-msg { background:#ffebee; border-left:4px solid #f44336; padding:0.8rem; color:#c62828; margin-bottom:1rem; border-radius:4px; }
</style>

<div class="form-container">
  <h2 style="margin-top:0;">üìö –°–µ–º–µ—Å—Ç—Ä “Ø“Ø—Å–≥—ç—Ö</h2>

  {% if error %}
    <div class="error-msg">‚ö†Ô∏è {{ error }}</div>
  {% endif %}

  <form method="POST">
    {% csrf_token %}

    <div class="form-group">
      <label>–°—É—Ä–≥—É—É–ª—å (–±–∞–π—Ä—à–∏–ª):</label>
      <select name="school_id" required>
        <option value="">–°—É—Ä–≥—É—É–ª—å —Å–æ–Ω–≥–æ–Ω–æ —É—É</option>
        {% for s in schools %}
          <option value="{{ s.0 }}" {% if s.0 == selected_school_id %}selected{% endif %}>{{ s.1 }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="row">
      <div class="form-group">
        <label>–°—É—Ä–≥—É—É–ª–∏–π–Ω –∂–∏–ª:</label>
        <input type="number" name="school_year" required min="2000" max="2100" value="{% now 'Y' %}">
      </div>

      <div class="form-group">
        <label>–°–µ–º–µ—Å—Ç—Ä:</label>
        <select name="term" required>
          <option value="">–°–æ–Ω–≥–æ–Ω–æ —É—É</option>
          <option value="1">1-—Ä —Å–µ–º–µ—Å—Ç—Ä (9-12 —Å–∞—Ä)</option>
          <option value="2">2-—Ä —Å–µ–º–µ—Å—Ç—Ä (1-6 —Å–∞—Ä)</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="form-group">
        <label>–≠—Ö–ª—ç—Ö –æ–≥–Ω–æ–æ:</label>
        <input type="date" name="start_date" required>
      </div>
      <div class="form-group">
        <label>–¢”©–≥—Å”©—Ö –æ–≥–Ω–æ–æ:</label>
        <input type="date" name="end_date" required>
      </div>
    </div>

    <div class="btn-row">
      <button type="submit" class="btn-primary">‚úì “Æ“Ø—Å–≥—ç—Ö</button>
      <a href="{% url 'semester_list' %}"><button type="button" class="btn-secondary">‚Üê –ë—É—Ü–∞—Ö</button></a>
    </div>
  </form>
</div>

<script>
  const termSelect = document.querySelector('select[name="term"]');
  const startInput = document.querySelector('input[name="start_date"]');
  const endInput = document.querySelector('input[name="end_date"]');

  termSelect.addEventListener('change', () => {
    const nowYear = new Date().getFullYear();

    if (termSelect.value === "1") {
      startInput.value = `${nowYear}-09-01`;
      endInput.value = `${nowYear}-12-29`;
    }

    if (termSelect.value === "2") {
      const nextYear = nowYear + 1;
      startInput.value = `${nextYear}-01-15`;
      endInput.value = `${nextYear}-06-01`;
    }
  });
</script>


{% endblock %}
